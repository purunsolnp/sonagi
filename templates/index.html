<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ê²€ì‚¬ ì¼ì • í™•ì¸ by ì†Œë‚˜ê¸°</title>
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-RS9JDK6N0R"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'G-RS9JDK6N0R');
  </script>
  <style>
    body { font-family: sans-serif; line-height: 1.6; }
    .input-row { display: flex; align-items: center; gap: 10px; margin-bottom: 10px; }
    .clear-btn { height: 30px; padding: 0 12px; font-size: 14px; }
    .main-btn { height: 40px; font-size: 16px; padding: 0 20px; }
    .button-group { display: flex; flex-wrap: wrap; gap: 10px; margin: 20px 0; }
    .result-box {
      font-size: 16px;
      line-height: 1.4;
      padding: 10px;
      border: 1px solid #ddd;
      background-color: #f9f9f9;
      max-height: 350px;
      overflow-y: auto;
    }
  </style>
</head>
<body>
  <h2>ê²€ì‚¬ ì¼ì • í™•ì¸ by ì†Œë‚˜ê¸° 2025-03-23 ë²„ì ¼</h2>
  <form method="post">
    <div class="input-row">
      <label for="visit_date">ì´ˆì§„ì¼:</label>
      <input type="date" id="visit_date" name="visit_date" value="{{ visit_date }}">
      <button type="button" class="clear-btn" onclick="clearVisitDate()">ì´ˆê¸°í™”</button>
    </div>
    <div class="input-row">
      <label for="target_date">ì§„ë£Œì¼:</label>
      <input type="date" id="target_date" name="target_date" value="{{ target_date }}">
      <button type="button" class="clear-btn" onclick="clearTargetDate()">ì´ˆê¸°í™”</button>
    </div>
    <label for="exam_list">ê²€ì‚¬ ëª©ë¡ ì…ë ¥ (ì‰¼í‘œë¡œ êµ¬ë¶„):</label>
    <div class="input-row">
      <input type="text" id="exam_list" name="exam_list" value="{{ exam_list }}" placeholder="ì˜ˆ: PHQ-9, ASRS, FY753280, ì¦ìƒ ë° í–‰ë™ í‰ê°€ ì²™ë„ - Level â…¡ [ë°˜ì¶”ì  ë°˜ì‘ ì²™ë„ RRS]" style="width: 100%; max-width: 700px; height: 30px; font-size: 16px;">
      <button type="button" class="clear-btn" onclick="clearExamList()">ì´ˆê¸°í™”</button>
    </div>

    {% if mapped_names and not result_text %}
    <div style="margin-top: 10px; padding: 10px; border: 1px solid #ccc; border-radius: 5px; background-color: #f9f9f9;">
      <strong>ì…ë ¥ê°’ â†’ ì •ì‹ ê²€ì‚¬ëª… ë§¤í•‘ ê²°ê³¼:</strong><br>
      {% for line in mapped_names %}{{ line }}<br>{% endfor %}
    </div>
    {% endif %}

    <div class="button-group">
      <button type="submit" class="main-btn">ê²€ì‚¬ ì¼ì • í™•ì¸</button>
      <button type="button" class="main-btn" onclick="clearAll()">All Clear</button>
      <a href="https://docs.google.com/spreadsheets/d/1om7_hy5ji_kUVpunx8b3LwyQDW1eZ1bhdkZHwGLWby8/edit?usp=sharing" target="_blank">
        <button type="button" class="main-btn">ê²€ì‚¬ ëª©ë¡ ì—´ëŒ</button>
      </a>
    </div>
  </form>

  <div id="result" class="result-box">{{ result_text | safe }}</div>

  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const today = new Date().toISOString().split('T')[0];

      const visitInput = document.getElementById("visit_date");
      const targetInput = document.getElementById("target_date");

      if (!visitInput.value) visitInput.value = today;
      if (!targetInput.value) targetInput.value = today;

      const examInput = document.getElementById("exam_list");
      examInput.addEventListener("paste", function (event) {
        event.preventDefault();
        let paste = (event.clipboardData || window.clipboardData).getData("text");
        paste = paste.replace(/[\n\r\t]+/g, ",").replace(/\s{2,}/g, ",").replace(/,+/g, ",").trim();
        let current = examInput.value;
        if (current && !current.trim().endsWith(",")) current += ", ";
        examInput.value = current + paste;
      });
    });

    function clearVisitDate() {
      const today = new Date().toISOString().split('T')[0];
      document.getElementById("visit_date").value = today;
    }
    function clearTargetDate() {
      const today = new Date().toISOString().split('T')[0];
      document.getElementById("target_date").value = today;
    }
    function clearExamList() {
      document.getElementById("exam_list").value = "";
    }
    function clearAll() {
      const today = new Date().toISOString().split('T')[0];
      document.getElementById("visit_date").value = today;
      document.getElementById("target_date").value = today;
      clearExamList();
    }
  </script>

  {% if not result %}
  <div class="result-box">
    <p>ğŸ“Œ ì‚¬ìš©ë²• ìœ íŠœë¸Œ ì„¤ëª… ë§í¬(ì†Œí†µì€ ìœ íŠœë¸Œ ëŒ“ê¸€ë¡œ!) : <a href="https://youtu.be/qjuiwCUTdjU" target="_blank">ì—¬ê¸° í´ë¦­, ìƒê°ë³´ë‹¤ ë§ì€ ê¸°ëŠ¥ì´ ìˆìŠµë‹ˆë‹¤.</a></p>
    <p>ğŸ“Œ ì´ˆì§„ì¼ê³¼ ì§„ë£Œì¼ì„ ì„¤ì •í•œ í›„ ê²€ì‚¬ ëª©ë¡ì„ ì…ë ¥í•˜ì„¸ìš”.</p>
    <p>ğŸ“Œ ê²€ì‚¬ ê²°ê³¼ë¥¼ ë¹ˆ ì¹¸ìœ¼ë¡œ ì„¤ì •í•˜ê³  ê²€ì‚¬ ì¼ì • ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ì„¤ì •í•œ ì´ˆì§„ì¼ ê¸°ì¤€ 7ê°œì›”ì°¨ê°€ ë˜ëŠ” ë‚ ì„ ì•Œë ¤ì¤ë‹ˆë‹¤.</p>
    <p>ğŸ“Œ ì´ˆì§„ ë‚ ì§œë¥¼ ì„ íƒí•˜ê³ , ì‹œí–‰í•  ê²€ì‚¬ë¥¼ ì‰¼í‘œë¡œ êµ¬ë¶„í•˜ì—¬ ì…ë ¥í•˜ë©´ ê²€ì‚¬ ê°¯ìˆ˜, í‰ê°€ í•­ëª©, ìê°€ ì„ìƒê°€ ì—¬ë¶€ê°€ íŒë‹¨ë˜ì–´ ê²°ê³¼ë¥¼ ì•Œë ¤ë“œë¦½ë‹ˆë‹¤.</p>
    <p>ğŸ“Œ ì´ì§€ìŠ¤ ê¸°ì¤€ "ê³„ì‚°ì½”ë“œ"ì—´ì˜ ì²˜ë°©ì„ ë“œë˜ê·¸ í›„ ë³µì‚¬/ë¶™ì—¬ë„£ê¸°ë¡œë„ ì‚¬ìš©ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤. íŠ¸ë£¨ë‹¥ì—ì„œë„ ìœ ì‚¬í•œ ë©”ì»¤ë‹ˆì¦˜ìœ¼ë¡œ ê°€ëŠ¥í•©ë‹ˆë‹¤.</p>
    <p>ğŸ“Œ ë³´í˜¸ì ì‘ì„±ì˜ ìê°€ ê²€ì‚¬ëŠ” 'ìê°€ê²€ì‚¬'ë¡œ ë¶„ë¥˜í•˜ì—¬ ì œì‘í•˜ì˜€ìŠµë‹ˆë‹¤.</p>
    <p>ğŸ“Œ ë³¸ í˜ì´ì§€ëŠ” ì„ ìƒë‹˜ë“¤ì˜ ì§„ë£Œë¥¼ ë•ê¸° ìœ„í•´ ìë°œì ìœ¼ë¡œ ì œì‘ë˜ì—ˆìœ¼ë©°, ì´ë¡œ ì¸í•´ ë°œìƒí•œ ì±…ì„ì€ ì‚¬ìš©ìì˜ ëª«ì„ì„ ê³ ì§€í•©ë‹ˆë‹¤.</p>
    <p>ğŸ“Œ ê°œì¸ì •ë³´ ë³´í˜¸ë²•ì„ ì¤€ìˆ˜í•˜ë©°, ì–´ë–¤ ë°ì´í„°ë„ ì €ì¥í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</p>
    <p>ğŸ“Œ ê²€ì‚¬ ëª…ì¹­ì€ ì²™ë„ ê³ ì‹œ ê¸°ì¤€ìœ¼ë¡œ ì •ì˜í•˜ì˜€ìŠµë‹ˆë‹¤, ìì„¸í•œ ê²ƒì€ ê²€ì‚¬ ëª©ë¡ ì—´ëŒì„ í™•ì¸í•´ì£¼ì„¸ìš”. (ì˜ˆì™¸: ASRS â†’ K-ASRS ë“±).</p>
  </div>
  {% endif %}

  <hr>

  <div style="text-align: center; margin-top: 40px;">
    <h3>â˜• ì œì‘ì í›„ì›í•˜ê¸°</h3>
    <p style="font-size: 14px;">
      ë„ì›€ì´ ë˜ì…¨ë‹¤ë©´ ì•„ë˜ í”Œë«í¼ì„ í†µí•´ ì‘ì›í•´ì£¼ì‹œë©´ ì„œë²„ ìš´ì˜ì— í° í˜ì´ ë©ë‹ˆë‹¤.
    </p>
    <a href="https://buymeacoffee.com/sonagi" target="_blank">
      <button style="background-color: #FFDD00; color: black; border: none; padding: 10px 20px; font-size: 16px; border-radius: 6px; cursor: pointer;">
        ë”°ëœ»í•œ í›„ì› ê°ì‚¬ë“œë¦½ë‹ˆë‹¤
      </button>
    </a>
  </div>
</body>
</html>
