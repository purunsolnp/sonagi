<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>검사 일정 확인</title>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5416878787637086" crossorigin="anonymous"></script>
	<!-- ✅ 스타일 추가 (결과창 크기 조정 및 가독성 향상) -->
    <style>
        .result-box {
            font-size: 16px;
            line-height: 1.5;
            padding: 10px;
            border: 1px solid #ddd;
            background-color: #f9f9f9;
            min-height: 100px;  /* 최소 높이 지정 */
        }
    </style>
</head>
<body>
    <h2>검사 일정 확인</h2>

    <form method="post">
        <label for="visit_date">초진 날짜 선택:</label>
        <input type="date" id="visit_date" name="visit_date" required>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        let visitDateInput = document.getElementById("visit_date");

        // 오늘 날짜를 YYYY-MM-DD 형식으로 변환
        if (!visitDateInput.value) {  // 값이 없을 경우에만 설정
            let today = new Date();
            let yyyy = today.getFullYear();
            let mm = String(today.getMonth() + 1).padStart(2, '0');
            let dd = String(today.getDate()).padStart(2, '0');
            let todayStr = yyyy + '-' + mm + '-' + dd;
            visitDateInput.value = todayStr;
        }
    });
</script>

        <br><br>

        <label for="exam_list">검사 목록 입력 (쉼표로 구분):</label>
        <div style="display: flex; align-items: center; gap: 10px;">
            <input type="text" id="exam_list" name="exam_list" value="{{ exam_list }}" 
                   style="width: 400px; height: 30px; font-size: 16px;">
            <button type="button" onclick="clearFields()" style="height: 34px; font-size: 16px;">Clear</button>
        </div>

        <br>

        <button type="submit" style="width: 180px; height: 40px; font-size: 18px;">검사 일정 확인</button>
    </form>
    <a href="https://docs.google.com/spreadsheets/d/1VorjjuS8TcrijJpLUnm5k6L1REOq65v2eWxs-ozlGYQ/view?usp=sharing" target="_blank">
        <button style="font-size: 16px; margin-top: 10px;">📄 검사 목록 열람</button>
    </a>
    <div id="result" class="result-box" style="font-size:18px; line-height:1.8;">
        {{ result_text | safe }}
    </div>
    <hr>

    <script>
        function clearFields() {
            document.getElementById("exam_list").value = "";
        }
    </script>
	<!-- 결과 메시지 출력 -->
	{% if result %}
		<div class="result-box">
			{{ result_text | safe }}
		</div>
	{% else %}
		<div class="result-box" style="color: gray;">
        📌 초진 일자는 현재 날짜가 기본 설정입니다. 환자의 초진 날짜로 바꿔서 사용해주세요.<br>
        📌 검사 결과를 빈 칸으로 설정하고 검사 일정 버튼을 눌리면 설정한 초진일 기준 7개월차가 되는 날을 알려줍니다.<br>
        📌 초진 날짜를 선택하고, 시행할 검사를 쉼표로 구분하여 입력하면 검사 갯수, 평가 항목 , 자가 임상가 여부가 판단되어 결과를 알려드립니다.<br>
        📌 본 페이지는 선생님들의 진료를 돕기위해 자발적으로 제작되었으며, 이로 인해 발생한 책임은 사용자의 몫임을 고지합니다.<br>
        📌 만약 본 페이지가 도움이 되었다면 아래 광고를 클릭해주시면 서버비등 운영에 큰 도움이 됩니다.<br>
        📌 본 페이지는 개인정보법등의 준수를 위해 그 어떠한 데이터도 저장하지 않으니 걱정하지 마시기 바랍니다.<br>
		</div>
	{% endif %}

    <hr>


	<!-- Clear 버튼 기능 추가 -->
<script>
    function clearFields() {
        document.getElementById("visit_date").value = "";
        document.getElementById("exam_list").value = "";
    }
</script>

</body>
</html>